{% extends "base.html" %}

{% block content %}

<style>
.article-container {
    max-width: 800px;
    margin: 0 auto;
}

.article-meta {
    color: #555;
    margin-bottom: 8px;
}

.article-actions {
    margin-top: 20px;
}

.article-actions h3 {
    margin-bottom: 10px;
}

.article-actions a,
.article-actions button {
    margin-right: 8px;
    margin-bottom: 8px;
}

button {
    padding: 6px 12px;
    cursor: pointer;
}
</style>

<div class="article-container">

    <h1>{{ newsletter.title }}</h1>

    <p class="article-meta">
        <strong>Author:</strong> {{ newsletter.journalist }}
    </p>

    <p class="article-meta">
        <strong>Status:</strong>
        {% if newsletter.approved %}
            Published
        {% else %}
            Draft / Pending
        {% endif %}
    </p>

    <hr>

    <p>{{ article.content }}</p>

    <hr>

    {# ===== JOURNALIST ACTIONS ===== #}
    {% if user.role == "journalist" and newsletter.author == user %}
        <div class="article-actions">
            <h3>Journalist Actions</h3>

            <a href="{% url 'newsapp:newsletter_update' newsletter.pk %}">
                <button>Edit Newsletter</button>
            </a>

            <a href="{% url 'newsapp:newsletter_delete' newsletter.pk %}">
                <button>Delete Newsletter</button>
            </a>
        </div>
    {% endif %}

    {# ===== EDITOR ACTIONS ===== #}
    {% if user.role == "editor" and newsletter.publisher and user.publisher == newsletter.publisher %}
        <div class="article-actions">
            <h3>Editor Actions</h3>

            <a href="{% url 'newsapp:newsletter_update' newsletter.pk %}">
                <button>Edit Article</button>
            </a>

            <a href="{% url 'newsapp:newsletter_delete' newsletter.pk %}">
                <button>Delete Article</button>
            </a>

            {% if not newsletter.approved %}
                <form method="post" action="{% url 'newsapp:approve_newsletter' newsletter.pk %}" style="display:inline;">
                    {% csrf_token %}
                    <button type="submit">Publish Newsletter</button>
                </form>
            {% endif %}
        </div>
    {% endif %}

    {# ===== READERS: READ-ONLY (NO ACTIONS) ===== #}

    <hr>

<form method="post" action="{% url 'newsapp:subscribe' newsletter.pk %}">
    {% csrf_token %}
    <button type="submit">Subscribe</button>
</form>

<a href="{% url 'newsapp:article_list' %}">
    <button type="button">Back to Articles</button>
</a>

</div>

{% endblock %}
